{"version":3,"sources":["jelli/hackday_environ_manager/forms.cljs"],"mappings":"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","names":["jelli.hackday-environ-manager.forms/new-tab-href","link","js/jelli","js/jelli.hackday-environ-manager","js/jelli.hackday-environ-manager.forms","js/jelli.hackday-environ-manager.forms.data-driven-field","method-table__4701__auto__","cljs.core.atom","prefer-table__4702__auto__","method-cache__4703__auto__","cached-hierarchy__4704__auto__","hierarchy__4705__auto__","cljs.core.get","fexpr__58430","cljs.core/MultiFn","cljs.core.symbol","jelli.hackday-environ-manager.forms/data-driven-field","field-def","cursor","p1__58431#","re-com.core/input-textarea","cljs.core/reset!","p1__58432#","re-com.core/checkbox","p1__58433#","re-com.core/input-text","p1__58434#","cljs.core/deref","clojure.string/blank?","p1__58435#","with-let58437","reagent.ratom/with-let-values","temp__5757__auto__","reagent.ratom/*ratom-context*","c__50045__auto__","reagent.debug/has-console","reagent.debug/tracking","reagent.debug/track-console","js/console","init58438","cljs.core/not","res58439","p1__58436#","to-add-env-key","reagent.core.atom","to-add-override","cljs.core.doall","iter__4611__auto__","s__58441","cljs.core/LazySeq","temp__5753__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4609__auto__","size__4610__auto__","cljs.core/count","b__58443","cljs.core/chunk-buffer","i__58442","vec__58444","cljs.core/-nth","cljs.core.nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__58440","cljs.core/chunk-rest","vec__58447","cljs.core/first","cljs.core/cons","cljs.core/rest","env-key","override","cljs.core.swap_BANG_","cljs.core/dissoc","or__4212__auto__","s__58451","b__58453","i__58452","iter__58450","k","re_frame.core.subscribe","cljs.core/assoc","cljs.core/boolean","and__4210__auto__","p__58454","map__58455","cljs.core/--destructure-map","jelli.hackday-environ-manager.forms/data-driven-form","field-defs","data-atom","on-submit","s__58457","b__58459","i__58458","iter__58456","reagent.core/cursor","G__58460","cljs.core/chunk-first"],"sourcesContent":["(ns jelli.hackday-environ-manager.forms\n  (:require [reagent.core :as reagent]\n            [re-com.core :as re-com]\n            [clojure.string]\n            [re-frame.core :as re-frame]\n            [jelli.hackday-environ-manager.subs :as subs]))\n\n(defn- new-tab-href [link]\n  {:href link\n   :target \"_blank\"})\n\n(defmulti data-driven-field (fn [field-def cursor]\n                              (:type field-def)))\n\n(defmethod data-driven-field :default\n  [field-def cursor]\n  [:label.label (:name field-def)\n   [re-com/input-textarea\n    :class \"textarea\"\n    :placeholder (:name field-def)\n    :model cursor\n    :on-change #(reset! cursor %)]])\n\n(defmethod data-driven-field :fields/bool\n  [field-def cursor]\n  [re-com/checkbox\n   :model cursor\n   :label-class \"checkbox\"\n   :on-change #(reset! cursor %)\n   :label (:name field-def)])\n\n(defmethod data-driven-field :fields/string\n  [field-def cursor]\n  [:label.label (:name field-def)\n   [re-com/input-text\n    :class \"input\"\n    :placeholder (:name field-def)\n    :model cursor\n    :on-change #(reset! cursor %)]])\n\n(defmethod data-driven-field :fields/url\n  [field-def cursor]\n  [:div.field.is-horizontal\n   [:label.label (:name field-def)\n    [re-com/input-text\n     :width \"100%\"\n     :class \"input\"\n     :placeholder (:name field-def)\n     :model cursor\n     :on-change #(reset! cursor %)]]\n   (when-not (clojure.string/blank? @cursor)\n     [:a (new-tab-href @cursor)\n      [:span.icon>i.mdi.mdi-open-in-new]])])\n\n(defmethod data-driven-field :fields/env-url\n  [field-def cursor]\n  [:div.field\n   [:label.label (:name field-def)\n    [re-com/input-text\n     :width \"100%\"\n     :class \"input\"\n     :placeholder (:name field-def)\n     :model cursor\n     :change-on-blur? false\n     :on-change #(reset! cursor %)]]])\n\n(defmethod data-driven-field :fields/env-url-map\n  [field-def cursor]\n  (reagent/with-let [to-add-env-key (reagent/atom nil)\n                     to-add-override (reagent/atom nil)]\n    [:div.box.field\n     [:label.label (:name field-def)]\n     [:table.table.is-narrow\n      [:thead [:tr [:th \"Env\"] [:th \"Override\"] [:th]]]\n      [:tbody\n       (doall\n        (for [[env-key override] @cursor]\n          ^{:key env-key}\n          [:tr [:td env-key] [:td override]\n           [:td [:a>span.icon.has-text-danger {:on-click #(swap! cursor dissoc env-key)}\n                 [:i.mdi.mdi-delete]]]]))]]\n     [:div.field.is-horizontal\n      [:div.dropdown.is-hoverable\n       [:div.dropdown-trigger>button.button\n        [:span (or @to-add-env-key \"env\")]\n        [:span.icon>i.mdi.mdi-chevron-down]]\n       [:div.dropdown-menu>div.dropdown-content\n        (doall\n         (for [k @(re-frame/subscribe [::subs/env-keys])]\n           ^{:key k}\n           [:a.dropdown-item {:on-click #(reset! to-add-env-key k)}\n            k]))]]\n      [re-com/input-text\n       :class \"input\"\n       :model to-add-override\n       :width \"45%\"\n       :change-on-blur? false\n       :on-change #(reset! to-add-override %)]\n      [:button.button.is-primary\n       {:on-click #(do (swap! cursor assoc @to-add-env-key @to-add-override)\n                       (reset! to-add-env-key nil)\n                       (reset! to-add-override nil))\n        :disabled (boolean (not (and @to-add-env-key @to-add-override)))}\n       [:span \"Add Override\"]\n       [:span.icon>i.mdi.mdi-plus]]]]))\n\n(defn data-driven-form [{:keys [field-defs data-atom on-submit]}]\n  [:div\n   (doall\n    (for [field-def field-defs\n          :let [cursor (reagent/cursor data-atom [(:key field-def)])]]\n      ^{:key (:key field-def)}\n      [data-driven-field field-def cursor]))\n   [:button.button.is-primary\n    {:on-click #(on-submit @data-atom)}\n    \"Save\"]])\n"]}